---
import { Code } from 'astro:components';
import Layout from '@layouts/BaseLayout.astro';
import '@styles/components/_code-block.css';
import '@styles/components/_demo-container.css';
import '@styles/components/_mask-reveal.css';

const meta = {
  title: 'Custom Animation Demo — PandaMotion',
  description: 'Example of using custom @keyframes with data-animate',
  imageOG: 'generic-social-1200x630.png',
  altOG: 'Custom Animation',
};
---

<Layout metaData={meta}>
  <main class="wrapper flow">
    <h1>Custom Animations</h1>
    <p>
      You're not limited to the 7 built-in animation types. Define your own
      <code>@keyframes</code> in a <code>&lt;style is:global&gt;</code> block, map them with
      <code>[data-animate="custom-name"].is-animating &#123; animation-name: custom-name; &#125;</code>,
      then trigger them with <code>data-animate="custom-name"</code>. The IntersectionObserver
      system handles timing and triggering automatically.
    </p>

    <!-- ============ Mask Reveal ============ -->
    <section class="flow">
      <h2>Mask Reveal Animation</h2>
      <p>
        This example uses a custom <code>@keyframes mask-reveal</code> with CSS
        <code>clip-path</code> to create a sliding mask effect. Perfect for dramatic
        text reveals.
      </p>

      <!-- Demo -->
      <div class="demo-container">
        <h3
          data-animate="mask-reveal"
          class="mask-reveal-text"
          data-animate-duration="1700"
        >
          Revealed on scroll
        </h3>
        <p
          data-animate="mask-reveal"
          class="mask-reveal-text"
          data-animate-duration="1700"
        >
          This text slides in behind a moving mask. The effect is pure CSS —
          clip-path animates while the text stays static.
        </p>
      </div>

      <!-- Code -->
      <h3>How to use it</h3>
      <p>
        Define custom <code>@keyframes</code> in a <code>&lt;style is:global&gt;</code> block,
        then reference them with <code>data-animate</code>. The <code>is:global</code> attribute
        ensures the styles are available to the animation system.
      </p>
      <Code code={`<!-- HTML -->
<h2 data-animate="mask-reveal" class="mask-reveal-text">
  Revealed on scroll
</h2>

<!-- In your Astro component: -->
<style is:global>
  /* Map animation type to keyframe name */
  [data-animate="mask-reveal"].is-animating {
    animation-name: mask-reveal;
  }

  /* Define the keyframe */
  @keyframes mask-reveal {
    from {
      clip-path: inset(0 100% 0 0);
    }
    to {
      clip-path: inset(0 0 0 0);
    }
  }
</style>

<!-- Optional: page-scoped styles for element appearance -->
<style>
  .mask-reveal-text {
    font-weight: 700;
    font-size: 1.5rem;
    color: #000;
  }
</style>`} lang="astro" />

      <h3>Customization</h3>
      <p>
        Use <code>data-animate-duration</code>,
        <code>data-animate-delay</code>, and
        <code>data-animate-easing</code> to fine-tune the effect:
      </p>
      <Code code={`<h2
  data-animate="mask-reveal"
  class="mask-reveal-text"
  data-animate-duration="1200"
  data-animate-easing="ease-out-3"
>
  Custom timing
</h2>`} lang="html" />

      <div class="demo-container" style="margin-top: 3rem;">
        <h3
          data-animate="mask-reveal"
          class="mask-reveal-text"
          data-animate-duration="1700"
          data-animate-easing="ease-out-3"
        >
          Reveal with easing
        </h3>
      </div>
    </section>


    <!-- ============ Tips ============ -->
    <section class="flow">
      <h2>Tips for Custom Animations</h2>
      <ul>
        <li>
          <strong>Use <code>&lt;style is:global&gt;</code>:</strong> Define custom keyframes and animation mappings
          in a global style block so they're available to the animation system
        </li>
        <li>
          <strong>Use meaningful names:</strong>
          <code>data-animate="mask-reveal"</code> is self-documenting
        </li>
        <li>
          <strong>Keep keyframes simple:</strong> Complex animations are heavier for
          the browser to compute
        </li>
        <li>
          <strong>Combine with built-in props:</strong>
          <code>data-animate-duration</code>,
          <code>data-animate-easing</code>, and
          <code>data-animate-delay</code> all work with custom keyframes
        </li>
        <li>
          <strong>Test performance:</strong> Use DevTools to check frame rate on low-end
          devices
        </li>
        <li>
          <strong>Respect prefers-reduced-motion:</strong> Custom animations are automatically
          disabled in the <code>@media (prefers-reduced-motion: reduce)</code>
          block injected by <code>&lt;AstroAnimations /&gt;</code>
        </li>
      </ul>
    </section>
  </main>
</Layout>

<style is:global>
  /* Custom animation: mask-reveal
     Map the animation name and define the keyframes */
  [data-animate="mask-reveal"].is-animating {
    animation-name: mask-reveal;
  }

  @keyframes mask-reveal {
    from {
      clip-path: inset(0 100% 0 0);
    }
    to {
      clip-path: inset(0 0 0 0);
    }
  }
</style>
